<!DOCTYPE html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="application-name" content="Agility Contest's Serial Chronometer Web Console" />
    <meta name="copyright" content="Â© 2019 Juan Antonio Martinez" />
    <meta name="author" lang="en" content="Juan Antonio Martinez" />
    <title>Now Running Web console</title>
    <script src="jquery-2.2.4.min.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="toogle-switch.css" />
    <style type="text/css">
        .input_number {
            width:50px;
            display:inline-block;
            padding:10px 0px 10px 0px;
        }

        .logo {
            background:url('AgilityContest.png') center no-repeat;
            background-size: 120px 100px;
            border:none;
            width:100px;
            height:80px;
            padding:5px
        }
    </style>
    <script type="text/javascript">
        function doLayout(dg,id,x,y,w,h) {
            var elem=$(id);
            elem.css('display','inline-block');
            elem.css('position','absolute');
            elem.css('float','left');
            // elem.css('padding','5px');
            elem.css('-webkit-box-sizing','border-box');
            elem.css('-moz-box-sizing','border-box');
            elem.css('box-sizing','border-box');
            elem.css('left',  ((25+x*100)/dg.cols)+'%');
            elem.css('top',   ((100+y*100)/dg.rows)+'%');
            elem.css('width', ((w*100)/dg.cols)+'%');
            elem.css('height',((h*100)/dg.rows)+'%');
            // elem.css('line-height',((h*100)/dg.rows)+'%');
            // elem.css('vertical-align','bottom');
        }

        function initialize() {
            $('#btn_turno').prop('checked',true);
            $('#sel_rec').val("0").prop('enabled',true);
            readData();
            setInterval(function() {readData();},5000);
            var layout= {'rows':55,'cols':145};
            doLayout(layout,"#Logo",5,5,25,15);
            doLayout(layout,"#Banner",35,5,105,5);
            doLayout(layout,"#Clock",35,15,45,25);
            doLayout(layout,"#FaltasLbl",85,15,15,5);
            doLayout(layout,"#Faltas",105,15,15,5);
            doLayout(layout,"#FaltasUp",125,15,5,5);
            doLayout(layout,"#FaltasDown",135,15,5,5);
            doLayout(layout,"#RehusesLbl",85,25,15,5);
            doLayout(layout,"#Rehuses",105,25,15,5);
            doLayout(layout,"#RehusesUp",125,25,5,5);
            doLayout(layout,"#RehusesDown",135,25,5,5);
            doLayout(layout,"#EliminadoLbl",85,35,15,5);
            doLayout(layout,"#Eliminado",105,35,15,5);
            doLayout(layout,"#EliminadoUp",125,35,5,5);
            doLayout(layout,"#EliminadoDown",135,35,5,5);
            doLayout(layout,"#TurnoLbl",5,25,15,5);
            doLayout(layout,"#Turno",25,25,15,5);
            doLayout(layout,"#RingLbl",5,35,15,5);
            doLayout(layout,"#Ring",25,35,5,5);
            doLayout(layout,"#ResetBtn",5,45,15,5);
            doLayout(layout,"#StartBtn" ,25,45,15,5);
            doLayout(layout,"#IntBtn",45,45,15,5);
            doLayout(layout,"#StopBtn",65,45,15,5);
            doLayout(layout,"#SalidaBtn",105,45,15,5);
            doLayout(layout,"#ReconocimientoBtn",125,45,15,5);
        }

        function readData() {
            $.ajax({
                url: '/readData',
                dataType: 'json',
                method: 'GET',
                data: { 'Operation':'readData' }, // not really needed, but...
                success: function(data){
                    $('#Faltas').val(data.F);
                    $('#Rehuses').val(data.R);
                    $('#Eliminado').val(data.E);
                    $('#Turno').val(data.D);
                    // if any event, parse it
                },
                error: function(){
                    alert('Error');
                }
            });
            return false;
        }

        function sendPost(url) {
            $.ajax({
                type: 'POST',
                url: url,
                dataType: 'json',
                data: $('#parameters').serialize()
            }).done(function(data) {
                // alert(JSON.stringify(data));
            }).fail(function(data) {
                alert("Error");
            });
            $('#sel_stop').val("0");
        }
        function writeData() {
            sendPost('/writeData');
        }

        function falta(val) { writeData(); }
        function rehuse(val) { writeData(); }
        function eliminado(val) { writeData(); }
        function reset(obj) { writeData(); }
        function start_run(obj) { writeData(); }
        function int_run(obj) { writeData(); }
        function stop_run(obj) { writeData(); }
        function reconocimiento() {}
        function salida() { }

    </script>
</head>
<body onload="initialize();">
<form id="parameters" autocomplete="off">
    <input type="hidden" name="message" id="message" value=""/>
    <span id="Logo"><a target="info" href="/getInfo"><img src="/AgilityContest.png" alt="logo"></a></span>
    <span id="Banner" class="title">AgilityContest Serial Chronometer Web Interface<</span>
    <span id="Clock"><a target="clock" href="/clock"><span class="clock">00:00</span></a>
    <label id="FaltasLbl" for="Faltas" class="data">Faltas:</label>
    <input id="Faltas"  class="data" type="text" readonly="readonly" name="F" value="Faltas">
    <input id="FaltasUp" class="data" type="button" name="FaltasUp" value="F+" onclick="falta(1)"/>
    <input id="FaltasDown"  class="data" type="button" name="FaltasDown" value="F-" onclick="falta(-1)">
    <label id="RehusesLbl" for="Rehuses" class="data">Rehuses:</label>
    <input id="Rehuses"  class="data" type="text" readonly="readonly" name="R" value="Rehuses">
    <input id="RehusesUp" class="data" type="button" name="RehusesUp" value="R+" onclick="rehuse(1);"/>
    <input id="RehusesDown"  class="data" type="button" name="RehusesDown" value="R-" onclick="rehuse(-1);">
    <label id="EliminadoLbl" for="Eliminado" class="data">Eliminado:</label>
    <input id="Eliminado"  class="data" type="text" readonly="readonly" name="F" value="Eliminado">
    <input id="EliminadoUp" class="data" type="button" name="EliminadoUp" value="F+" onclick="eliminado(1);"/>
    <input id="EliminadoDown"  class="data" type="button" name="EliminadoDown" value="F-" onclick="eliminado(-1);">


    <label id="TurnoLbl" for="Turno" class="data">Turno:</label>
    <input id="Turno"  class="data" type="text" readonly="readonly" name="Turno" value="Turno">

    <label id="RingLbl" for="Ring" class="data">Ring:</label>
    <input id="Ring"  class="data" type="text" readonly="readonly" name="Ring" value="Ring">

    <input id="ResetBtn" class="data" type="button" name="Reset" value="Reset" onclick="reset();"/>
    <input id="StartBtn" class="data" type="button" name="Start" value="Start" onclick="start_run();"/>
    <input id="IntBtn" class="data" type="button" name="Intermediate" value="T. Int." onclick="int_run();"/>
    <input id="StopBtn" class="data" type="button" name="Stop" value="Stop" onclick="stop_run();"/>
    <input id="SalidaBtn" class="data" type="button" name="Salida" value="15 Secs." onclick="salida();"/>
    <input id="ReconocimientoBtn" class="data" type="button" name="CourseWalk" value="CourseWalk" onclick="reconocimiento();"/>

    </span>
</form>
<span style="width:100%;display:block;text-align:right;font-style:italic;font-size:10px"><br/>Copyright &copy; 2019 by JAMC para AgilityContest 3.9.1</span>
</body>
</html>
